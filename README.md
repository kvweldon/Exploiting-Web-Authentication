# Exploiting-Web-Authentication


<h1>Phase 6</h1>

*This lab is run utilizing the DVWA(Damn Vulnerable Web Application) to help facilitate brute force and dictionary attack examples. Logging in to first DVWA is necessary to access the various challenges.*

**<p style="font-size: 15px;">Step 1: Discovering web credentials with a dictionary attack.</p>**

To start, I opened Firefox, went to dvwa.structureality.com, and logged in. Below is the initial log in page and the home page of the site. In the real world, I would attempt to exploit any logon prompt I discovered. 

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/20855de0-c962-4cde-8fba-6809d1ba6998)

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/be7d0a7b-acf5-47c0-bbe4-44927b494e59)

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/f52592c4-5dc3-4a16-8ce5-95eeb7e93aa1)

I selected the Brute Force tab to begin the challenge. I took a guess at a username and password and entered, "jordan:123abc". 

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/d2e6ace1-1338-474b-bd9d-afb865876641)

The username and password I entered were incorrect which resulted in the below error message along with the new URL.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/23549cc5-1b16-463b-80dc-559e2f6cde6f)

"http://dvwa.structureality.com/vulnerabilities/brute/?username=jordan&password=123abc&Login=Login#"

In order to successfully brute force the site, I needed to obtain the PHPSESSID cookie. It is allows websites to store, communicate, and manage serialized state data and is discarded when a browser is closed. I right clicked on the web page and selected "inspect" to bring forth the web page inspector pane.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/cf64ad6e-1a96-49f2-ae3a-32ce1c7031c7)

I then found the PHPSESSID, copied it, opened the Text Editor and pasted it. In a subsequent step, the PHPSESSID will be used in Hydra to perform a websession hijack. Utilizing the same session identifier allows Hydra to be seen as the original client by the web server. 

I then closed the web page inspector and opened the Terminal.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/4c2f6e42-13ae-43f8-9973-e834bcfedc22)

In the Terminal, I created two files with the potential usernames of root and admin by entering "echo root > users.txt" and "echo admin >> users.txt". I utilized the cat command to ensure the contents of the file was correct.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/9a255425-d39b-4291-ba25-34b3020cbb51)

Kali includes a variety of password lists, and I entered " ls -l /usr/share/seclists/Passwords" to display them.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/2e0166ba-bc24-43ad-8494-5f9e015c3605)

The UserPassCombo-Jay.txt file contains several of the passwords for the accounts on the DVWA site. I will utilize this file in my attacks. 

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/0a9f3528-d99e-45c6-a354-4642a194d25d)



![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/95b97c97-5154-4886-a734-d47de952f10d)

Below shows the command to perform a dictionary based password attack in Hydra against the DVWA site. -L specifies the file to be used for the username, users.txt and -P the password, /usr/share/seclists/Passwords/UserPassCombo-Jay.txt. The rest of the command, is a modified version of the URL displayed when I tried to log in to the site with the incorrect information. 

"http changed to(>)http-get-form, ?username>:username, jordan>^USERS^, 123abc>^PASS^, Login#>Login:" The "F=" is used to search for a failure string of "incorrect" to reject invalid credentials. The word "incorrect" was part of the error displayed after a failed login attempt. The "H=" is utilized to monitor the HTTP header response, specifically looking for the presence of "Cookie," which commonly indicates a successful login. The backslash (i.e.,\ ) is appended at the end of the header identifier to prevent hydra from executing parameter verification.

The "-V" parameter enables verbosity, prompting hydra to provide the task details during its operation. If I did not use this parameter the result would only display successful outcomes. I have included both URL's below for comparison:

"http://dvwa.structureality.com/vulnerabilities/brute/?username=jordan&password=123abc&Login=Login#"

hydra -L users.txt -P /usr/share/seclists/Passwords/UserPassCombo-Jay.txt 'http-get-form://dvwa.structureality.com/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=incorrect:H=Cookie\:PHPSESSID=jpgl0iuqo93oksrhhq7ic7m1ul; security=low' -V

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/2367b3b9-c6b7-4058-8a84-be4164ac642b)

The attack attempted over 837 of the 1454 avaliable passwords before finding the correct combination of admin:password. 

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/e1aacac8-8011-4192-bec1-06c1610baaf0)

I went back to the Firefox page that still showed the error message and input the newly discovered log in credentials.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/c2d6e193-9e3d-495f-8224-4bb43ed041a8)

Once entered the below screen returned with an account image and "Welcome to the password protected area admin" displayed.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/b938cdfb-ceba-4715-990a-0d8d6402d06c)

I right clicked on the image and selected "Open Image in New Tab to reveal the below.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/bf1971e7-52a4-4b60-b24d-f2d7deb24ac0)

In the address bar I removed the image filename of "admin.jpg" so that the URL was "dvwa.structureality.com/hackable/users/" and pressed enter. I was then brought to this page, which showed additional account images in the ../users/ directory. This design is obviously poor and has insufficient security management. 

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/4a71f156-2639-4192-ae7e-b01d3fec0d4b)

Next, I returned to the Terminal and added all of the discovered user names to the users.txt file with the "echo" command. I then displayed the contents of the file to ensure it was correct with the "cat" command. I then perforemd the same hydra command to try and obtain the passwords of the 4 usernames I added to the users.txt file, with 2 changes. I removed the "-V", Verbose parameter and added a parameter that would save the results to a file named creds.txt. The full command is below: 


hydra -L users.txt -P /usr/share/seclists/Passwords/UserPassCombo-Jay.txt 'http-get-form://dvwa.structureality.com/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=incorrect:H=Cookie\:PHPSESSID=<PHPSESSID>; security=low' -o creds.txt

The hydra attack was able to discover the passwords of the accounts "gordonb" and "smithy". I then displayed the hydra output file by entering "cat creds.txt". The dictionary attack was partially succesful, but it would allow us to elevate our privileges in the system and pivot.

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/07704153-067d-45c7-9a8e-7ce91d12128d)

**<p style="font-size: 15px;">Step 2: Brute forcing web credentials.</p>**

I edited my previous hydra command to perform a brute force attack against the "gordonb" account. I replaced "-L users.txt" with "-l gordonb",  "-P /usr/share/seclists/Passwords/UserPassCombo-Jay.txt" with "-x 5:6:a1", and added the "-V" verbose parameter to watch the attack play out.

"-l gordonb" specifies the username to use in the attack. "-x 5:6:a1",option specifies that Hydra should perform a brute-force attack using characters from the specified range. 5 indicates that the minimum password length is 5 characters. 6 indicates that the maximum password length is 6 characters. a1 indicates that the character set to be used for the attack is alphanumeric characters (lowercase letters followed by numbers).

The full command is below:

hydra -l gordonb -x 5:6:a1 'http-get-form://dvwa.structureality.com/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=incorrect:H=Cookie\:PHPSESSID=jpgl0iuqo93oksrhhq7ic7m1ul; security=low' -o creds.txt -V

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/66163951-c209-486b-b454-846fedc85420)

The brute force attack would have attempted every combination of possible passowrds based on the aforementioned parameters, a total of 2237248512 different possiblities. These pictures were used just to give an example of what the attempt would look like. I canceled the command using "ctrl+c". 

![image](https://github.com/kvweldon/Exploiting-Web-Authentication/assets/141193154/4f7f231c-d3b7-494f-ad8f-f339d97357af)










